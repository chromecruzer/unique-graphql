(()=>{"use strict";var e={257:(e,t)=>{t.Ll=function(e){const t=null==e?void 0:e.kind;return"string"==typeof t&&o.has(t)};class n{constructor(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class i{constructor(e,t,n,i,r,o){this.kind=e,this.start=t,this.end=n,this.line=i,this.column=r,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const r={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};const o=new Set(Object.keys(r));var s;!function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(s||(s={}))},338:(e,t,n)=>{const{EMPTY_BUFFER:i}=n(614),r=Buffer[Symbol.species];function o(e,t,n,i,r){for(let o=0;o<r;o++)n[i+o]=e[o]^t[3&o]}function s(e,t){for(let n=0;n<e.length;n++)e[n]^=t[3&n]}if(e.exports={concat:function(e,t){if(0===e.length)return i;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let o=0;for(let t=0;t<e.length;t++){const i=e[t];n.set(i,o),o+=i.length}return o<t?new r(n.buffer,n.byteOffset,o):n},mask:o,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let n;return t instanceof ArrayBuffer?n=new r(t):ArrayBuffer.isView(t)?n=new r(t.buffer,t.byteOffset,t.byteLength):(n=Buffer.from(t),e.readOnly=!1),n},unmask:s},!process.env.WS_NO_BUFFER_UTIL)try{const t=n(Object(function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.mask=function(e,n,i,r,s){s<48?o(e,n,i,r,s):t.mask(e,n,i,r,s)},e.exports.unmask=function(e,n){e.length<32?s(e,n):t.unmask(e,n)}}catch(e){}},614:e=>{const t=["nodebuffer","arraybuffer","fragments"],n="undefined"!=typeof Blob;n&&t.push("blob"),e.exports={BINARY_TYPES:t,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:n,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},597:(e,t,n)=>{const{kForOnEventAttribute:i,kListener:r}=n(614),o=Symbol("kCode"),s=Symbol("kData"),a=Symbol("kError"),c=Symbol("kMessage"),l=Symbol("kReason"),u=Symbol("kTarget"),d=Symbol("kType"),f=Symbol("kWasClean");class h{constructor(e){this[u]=null,this[d]=e}get target(){return this[u]}get type(){return this[d]}}Object.defineProperty(h.prototype,"target",{enumerable:!0}),Object.defineProperty(h.prototype,"type",{enumerable:!0});class p extends h{constructor(e,t={}){super(e),this[o]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[f]=void 0!==t.wasClean&&t.wasClean}get code(){return this[o]}get reason(){return this[l]}get wasClean(){return this[f]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class y extends h{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[c]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[c]}}Object.defineProperty(y.prototype,"error",{enumerable:!0}),Object.defineProperty(y.prototype,"message",{enumerable:!0});class m extends h{constructor(e,t={}){super(e),this[s]=void 0===t.data?null:t.data}get data(){return this[s]}}Object.defineProperty(m.prototype,"data",{enumerable:!0});const v={addEventListener(e,t,n={}){for(const o of this.listeners(e))if(!n[i]&&o[r]===t&&!o[i])return;let o;if("message"===e)o=function(e,n){const i=new m("message",{data:n?e:e.toString()});i[u]=this,_(t,this,i)};else if("close"===e)o=function(e,n){const i=new p("close",{code:e,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[u]=this,_(t,this,i)};else if("error"===e)o=function(e){const n=new y("error",{error:e,message:e.message});n[u]=this,_(t,this,n)};else{if("open"!==e)return;o=function(){const e=new h("open");e[u]=this,_(t,this,e)}}o[i]=!!n[i],o[r]=t,n.once?this.once(e,o):this.on(e,o)},removeEventListener(e,t){for(const n of this.listeners(e))if(n[r]===t&&!n[i]){this.removeListener(e,n);break}}};function _(e,t,n){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,n):e.call(t,n)}e.exports={CloseEvent:p,ErrorEvent:y,Event:h,EventTarget:v,MessageEvent:m}},926:(e,t,n)=>{const{tokenChars:i}=n(880);function r(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}e.exports={format:function(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let n,o,s=Object.create(null),a=!1,c=!1,l=!1,u=-1,d=-1,f=-1,h=0;for(;h<e.length;h++)if(d=e.charCodeAt(h),void 0===n)if(-1===f&&1===i[d])-1===u&&(u=h);else if(0===h||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h);const i=e.slice(u,f);44===d?(r(t,i,s),s=Object.create(null)):n=i,u=f=-1}}else-1===f&&-1!==u&&(f=h);else if(void 0===o)if(-1===f&&1===i[d])-1===u&&(u=h);else if(32===d||9===d)-1===f&&-1!==u&&(f=h);else if(59===d||44===d){if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h),r(s,e.slice(u,f),!0),44===d&&(r(t,n,s),s=Object.create(null),n=void 0),u=f=-1}else{if(61!==d||-1===u||-1!==f)throw new SyntaxError(`Unexpected character at index ${h}`);o=e.slice(u,h),u=f=-1}else if(c){if(1!==i[d])throw new SyntaxError(`Unexpected character at index ${h}`);-1===u?u=h:a||(a=!0),c=!1}else if(l)if(1===i[d])-1===u&&(u=h);else if(34===d&&-1!==u)l=!1,f=h;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${h}`);c=!0}else if(34===d&&61===e.charCodeAt(h-1))l=!0;else if(-1===f&&1===i[d])-1===u&&(u=h);else if(-1===u||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===f&&(f=h);let i=e.slice(u,f);a&&(i=i.replace(/\\/g,""),a=!1),r(s,o,i),44===d&&(r(t,n,s),s=Object.create(null),n=void 0),o=void 0,u=f=-1}}else-1===f&&(f=h);if(-1===u||l||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===f&&(f=h);const p=e.slice(u,f);return void 0===n?r(t,p,s):(void 0===o?r(s,p,!0):r(s,o,a?p.replace(/\\/g,""):p),r(t,n,s)),t}}},759:e=>{const t=Symbol("kDone"),n=Symbol("kRun");e.exports=class{constructor(e){this[t]=()=>{this.pending--,this[n]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[t])}}}},971:(e,t,n)=>{const i=n(106),r=n(338),o=n(759),{kStatusCode:s}=n(614),a=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),u=Symbol("total-length"),d=Symbol("callback"),f=Symbol("buffers"),h=Symbol("error");let p;function y(e){this[f].push(e),this[u]+=e.length}function m(e){this[u]+=e.length,this[l]._maxPayload<1||this[u]<=this[l]._maxPayload?this[f].push(e):(this[h]=new RangeError("Max payload size exceeded"),this[h].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[h][s]=1009,this.removeListener("data",m),this.reset())}function v(e){this[l]._inflate=null,e[s]=1007,this[d](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!p){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;p=new o(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[d];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){p.add((i=>{this._decompress(e,t,((e,t)=>{i(),n(e,t)}))}))}compress(e,t,n){p.add((i=>{this._compress(e,t,((e,t)=>{i(),n(e,t)}))}))}_decompress(e,t,n){const o=this._isServer?"client":"server";if(!this._inflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[u]=0,this._inflate[f]=[],this._inflate.on("error",v),this._inflate.on("data",m)}this._inflate[d]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush((()=>{const e=this._inflate[h];if(e)return this._inflate.close(),this._inflate=null,void n(e);const i=r.concat(this._inflate[f],this._inflate[u]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[u]=0,this._inflate[f]=[],t&&this.params[`${o}_no_context_takeover`]&&this._inflate.reset()),n(null,i)}))}_compress(e,t,n){const o=this._isServer?"server":"client";if(!this._deflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[u]=0,this._deflate[f]=[],this._deflate.on("data",y)}this._deflate[d]=n,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=r.concat(this._deflate[f],this._deflate[u]);t&&(e=new a(e.buffer,e.byteOffset,e.length-4)),this._deflate[d]=null,this._deflate[u]=0,this._deflate[f]=[],t&&this.params[`${o}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}}},286:(e,t,n)=>{const{Writable:i}=n(203),r=n(971),{BINARY_TYPES:o,EMPTY_BUFFER:s,kStatusCode:a,kWebSocket:c}=n(614),{concat:l,toArrayBuffer:u,unmask:d}=n(338),{isValidStatusCode:f,isValidUTF8:h}=n(880),p=Buffer[Symbol.species];e.exports=class extends i{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||o[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[c]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=new p(t.buffer,t.byteOffset+e,t.length-e),new p(t.buffer,t.byteOffset,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],i=t.length-e;e>=n.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new p(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);const t=this.consume(2);if(48&t[0]){return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"))}const n=!(64&~t[0]);if(!n||this._extensions[r.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(n){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(!this._fragmented){return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"))}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}this._compressed=n}else{if(!(this._opcode>7&&this._opcode<11)){return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"))}if(!this._fin){return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"))}if(n){return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked){return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}}else if(this._masked){return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"))}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else{e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);const t=this.consume(8),n=t.readUInt32BE(0);if(n>Math.pow(2,21)-1){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"))}else this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"))}else this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&d(t,this._mask)}if(this._opcode>7)this.controlMessage(t,e);else{if(this._compressed)return this._state=5,void this.decompress(t,e);t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}}decompress(e,t){this._extensions[r.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0){const e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(n)}this.dataMessage(t),0===this._state&&this.startLoop(t)}))}dataMessage(e){if(!this._fin)return void(this._state=0);const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let i;i="nodebuffer"===this._binaryType?l(n,t):"arraybuffer"===this._binaryType?u(l(n,t)):"blob"===this._binaryType?new Blob(n):n,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",i,!0),this._state=0,this.startLoop(e)})))}else{const i=l(n,t);if(!this._skipUTF8Validation&&!h(i)){const t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=0):(this._state=6,setImmediate((()=>{this.emit("message",i,!1),this._state=0,this.startLoop(e)})))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate((()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)})));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,s),this.end();else{const n=e.readUInt16BE(0);if(!f(n)){const e=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}const i=new p(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!h(i)){const e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",n,i),this.end()}this._state=0}}createError(e,t,n,i,r){this._loop=!1,this._errored=!0;const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,this.createError),o.code=r,o[a]=i,o}}},914:(e,t,n)=>{const{Duplex:i}=n(203),{randomFillSync:r}=n(982),o=n(971),{EMPTY_BUFFER:s,kWebSocket:a,NOOP:c}=n(614),{isBlob:l,isValidStatusCode:u}=n(880),{mask:d,toBuffer:f}=n(338),h=Symbol("kByteLength"),p=Buffer.alloc(4),y=8192;let m,v=y;class _{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=c,this[a]=void 0}static frame(e,t){let n,i,o=!1,s=2,a=!1;t.mask&&(n=t.maskBuffer||p,t.generateMask?t.generateMask(n):(v===y&&(void 0===m&&(m=Buffer.alloc(y)),r(m,0,y),v=0),n[0]=m[v++],n[1]=m[v++],n[2]=m[v++],n[3]=m[v++]),a=!(n[0]|n[1]|n[2]|n[3]),s=6),"string"==typeof e?i=t.mask&&!a||void 0===t[h]?(e=Buffer.from(e)).length:t[h]:(i=e.length,o=t.mask&&t.readOnly&&!a);let c=i;i>=65536?(s+=8,c=127):i>125&&(s+=2,c=126);const l=Buffer.allocUnsafe(o?i+s:s);return l[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(l[0]|=64),l[1]=c,126===c?l.writeUInt16BE(i,2):127===c&&(l[2]=l[3]=0,l.writeUIntBE(i,4,6)),t.mask?(l[1]|=128,l[s-4]=n[0],l[s-3]=n[1],l[s-2]=n[2],l[s-1]=n[3],a?[l,e]:o?(d(e,n,l,s,i),[l]):(d(e,n,e,0,i),[l,e])):[l,e]}close(e,t,n,i){let r;if(void 0===e)r=s;else{if("number"!=typeof e||!u(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");r=Buffer.allocUnsafe(2+n),r.writeUInt16BE(e,0),"string"==typeof t?r.write(t,2):r.set(t,2)}else r=Buffer.allocUnsafe(2),r.writeUInt16BE(e,0)}const o={[h]:r.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,r,!1,o,i]):this.sendFrame(_.frame(r,o),i)}ping(e,t,n){let i,r;if("string"==typeof e?(i=Buffer.byteLength(e),r=!1):l(e)?(i=e.size,r=!1):(i=(e=f(e)).length,r=f.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[h]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:r,rsv1:!1};l(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):0!==this._state?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(_.frame(e,o),n)}pong(e,t,n){let i,r;if("string"==typeof e?(i=Buffer.byteLength(e),r=!1):l(e)?(i=e.size,r=!1):(i=(e=f(e)).length,r=f.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[h]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:r,rsv1:!1};l(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,o,n]):this.getBlobData(e,!1,o,n):0!==this._state?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(_.frame(e,o),n)}send(e,t,n){const i=this._extensions[o.extensionName];let r,s,a=t.binary?2:1,c=t.compress;"string"==typeof e?(r=Buffer.byteLength(e),s=!1):l(e)?(r=e.size,s=!1):(r=(e=f(e)).length,s=f.readOnly),this._firstFragment?(this._firstFragment=!1,c&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=r>=i._threshold),this._compress=c):(c=!1,a=0),t.fin&&(this._firstFragment=!0);const u={[h]:r,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:s,rsv1:c};l(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,u,n]):this.getBlobData(e,this._compress,u,n):0!==this._state?this.enqueue([this.dispatch,e,this._compress,u,n]):this.dispatch(e,this._compress,u,n)}getBlobData(e,t,n,i){this._bufferedBytes+=n[h],this._state=2,e.arrayBuffer().then((e=>{if(this._socket.destroyed){const e=new Error("The socket was closed while the blob was being read");return void process.nextTick(g,this,e,i)}this._bufferedBytes-=n[h];const r=f(e);t?this.dispatch(r,t,n,i):(this._state=0,this.sendFrame(_.frame(r,n),i),this.dequeue())})).catch((e=>{process.nextTick(b,this,e,i)}))}dispatch(e,t,n,i){if(!t)return void this.sendFrame(_.frame(e,n),i);const r=this._extensions[o.extensionName];this._bufferedBytes+=n[h],this._state=1,r.compress(e,n.fin,((e,t)=>{if(this._socket.destroyed){g(this,new Error("The socket was closed while data was being compressed"),i)}else this._bufferedBytes-=n[h],this._state=0,n.readOnly=!1,this.sendFrame(_.frame(t,n),i),this.dequeue()}))}dequeue(){for(;0===this._state&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][h],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][h],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function g(e,t,n){"function"==typeof n&&n(t);for(let n=0;n<e._queue.length;n++){const i=e._queue[n],r=i[i.length-1];"function"==typeof r&&r(t)}}function b(e,t,n){g(e,t,n),e.onerror(t)}e.exports=_},719:(e,t,n)=>{const{Duplex:i}=n(203);function r(e){e.emit("close")}function o(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let n=!0;const a=new i({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,n){const i=!n&&a._readableState.objectMode?t.toString():t;a.push(i)||e.pause()})),e.once("error",(function(e){a.destroyed||(n=!1,a.destroy(e))})),e.once("close",(function(){a.destroyed||a.push(null)})),a._destroy=function(t,i){if(e.readyState===e.CLOSED)return i(t),void process.nextTick(r,a);let o=!1;e.once("error",(function(e){o=!0,i(e)})),e.once("close",(function(){o||i(t),process.nextTick(r,a)})),n&&e.terminate()},a._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){a._final(t)}))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,n,i){e.readyState!==e.CONNECTING?e.send(t,i):e.once("open",(function(){a._write(t,n,i)}))},a.on("end",o),a.on("error",s),a}},237:(e,t,n)=>{const{tokenChars:i}=n(880);e.exports={parse:function(e){const t=new Set;let n=-1,r=-1,o=0;for(;o<e.length;o++){const s=e.charCodeAt(o);if(-1===r&&1===i[s])-1===n&&(n=o);else if(0===o||32!==s&&9!==s){if(44!==s)throw new SyntaxError(`Unexpected character at index ${o}`);{if(-1===n)throw new SyntaxError(`Unexpected character at index ${o}`);-1===r&&(r=o);const i=e.slice(n,r);if(t.has(i))throw new SyntaxError(`The "${i}" subprotocol is duplicated`);t.add(i),n=r=-1}}else-1===r&&-1!==n&&(r=o)}if(-1===n||-1!==r)throw new SyntaxError("Unexpected end of input");const s=e.slice(n,o);if(t.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return t.add(s),t}}},880:(e,t,n)=>{const{isUtf8:i}=n(181),{hasBlob:r}=n(614);function o(e){const t=e.length;let n=0;for(;n<t;)if(128&e[n])if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}else n++;return!0}if(e.exports={isBlob:function(e){return r&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:o,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},i)e.exports.isValidUTF8=function(e){return e.length<24?o(e):i(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{const t=n(Object(function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}()));e.exports.isValidUTF8=function(e){return e.length<32?o(e):t(e)}}catch(e){}},722:(e,t,n)=>{const i=n(434),r=n(611),{Duplex:o}=n(203),{createHash:s}=n(982),a=n(926),c=n(971),l=n(237),u=n(60),{GUID:d,kWebSocket:f}=n(614),h=/^[+/0-9A-Za-z]{22}==$/;function p(e){e._state=2,e.emit("close")}function y(){this.destroy()}function m(e,t,n,i){n=n||r.STATUS_CODES[t],i={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...i},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${r.STATUS_CODES[t]}\r\n`+Object.keys(i).map((e=>`${e}: ${i[e]}`)).join("\r\n")+"\r\n\r\n"+n)}function v(e,t,n,i,r){if(e.listenerCount("wsClientError")){const i=new Error(r);Error.captureStackTrace(i,v),e.emit("wsClientError",i,n,t)}else m(n,i,r)}e.exports=class extends i{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:u,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=r.createServer(((e,t)=>{const n=r.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,i)=>{this.handleUpgrade(t,n,i,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(p,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(p,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{p(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,i){t.on("error",y);const r=e.headers["sec-websocket-key"],o=e.headers.upgrade,s=+e.headers["sec-websocket-version"];if("GET"!==e.method){return void v(this,e,t,405,"Invalid HTTP method")}if(void 0===o||"websocket"!==o.toLowerCase()){return void v(this,e,t,400,"Invalid Upgrade header")}if(void 0===r||!h.test(r)){return void v(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header")}if(8!==s&&13!==s){return void v(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header")}if(!this.shouldHandle(e))return void m(t,400);const u=e.headers["sec-websocket-protocol"];let d=new Set;if(void 0!==u)try{d=l.parse(u)}catch(n){return void v(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}const f=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==f){const n=new c(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const e=a.parse(f);e[c.extensionName]&&(n.accept(e[c.extensionName]),p[c.extensionName]=n)}catch(n){return void v(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){const o={origin:e.headers[""+(8===s?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(o,((o,s,a,c)=>{if(!o)return m(t,s||401,a,c);this.completeUpgrade(p,r,d,e,t,n,i)}));if(!this.options.verifyClient(o))return m(t,401)}this.completeUpgrade(p,r,d,e,t,n,i)}completeUpgrade(e,t,n,i,r,o,l){if(!r.readable||!r.writable)return r.destroy();if(r[f])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return m(r,503);const u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${s("sha1").update(t+d).digest("base64")}`],h=new this.options.WebSocket(null,void 0,this.options);if(n.size){const e=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;e&&(u.push(`Sec-WebSocket-Protocol: ${e}`),h._protocol=e)}if(e[c.extensionName]){const t=e[c.extensionName].params,n=a.format({[c.extensionName]:[t]});u.push(`Sec-WebSocket-Extensions: ${n}`),h._extensions=e}this.emit("headers",u,i),r.write(u.concat("\r\n").join("\r\n")),r.removeListener("error",y),h.setSocket(r,o,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(h),h.on("close",(()=>{this.clients.delete(h),this._shouldEmitClose&&!this.clients.size&&process.nextTick(p,this)}))),l(h,i)}}},60:(e,t,n)=>{const i=n(434),r=n(692),o=n(611),s=n(278),a=n(756),{randomBytes:c,createHash:l}=n(982),{Duplex:u,Readable:d}=n(203),{URL:f}=n(16),h=n(971),p=n(286),y=n(914),{isBlob:m}=n(880),{BINARY_TYPES:v,EMPTY_BUFFER:_,GUID:g,kForOnEventAttribute:b,kListener:E,kStatusCode:S,kWebSocket:w,NOOP:T}=n(614),{EventTarget:{addEventListener:k,removeEventListener:N}}=n(597),{format:x,parse:O}=n(926),{toBuffer:I}=n(338),D=3e4,L=Symbol("kAborted"),C=[8,13],P=["CONNECTING","OPEN","CLOSING","CLOSED"],A=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class U extends i{constructor(e,t,n){super(),this._binaryType=v[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=_,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=U.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(n=t,t=[]):t=[t]),j(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){v.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const i=new p({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation}),r=new y(e,this._extensions,n.generateMask);this._receiver=i,this._sender=r,this._socket=e,i[w]=this,r[w]=this,e[w]=this,i.on("conclude",K),i.on("drain",V),i.on("error",q),i.on("message",G),i.on("ping",Y),i.on("pong",H),r.onerror=J,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",X),e.on("data",Z),e.on("end",ee),e.on("error",te),this._readyState=U.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=U.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=U.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==U.CLOSED)if(this.readyState!==U.CONNECTING)this.readyState!==U.CLOSING?(this._readyState=U.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),Q(this)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();else{const e="WebSocket was closed before the connection was established";M(this,this._req,e)}}pause(){this.readyState!==U.CONNECTING&&this.readyState!==U.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===U.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===U.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||_,t,n)):$(this,e,n)}pong(e,t,n){if(this.readyState===U.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===U.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||_,t,n)):$(this,e,n)}resume(){this.readyState!==U.CONNECTING&&this.readyState!==U.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===U.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==U.OPEN)return void $(this,e,n);const i={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(i.compress=!1),this._sender.send(e||_,i,n)}terminate(){if(this.readyState!==U.CLOSED)if(this.readyState!==U.CONNECTING)this._socket&&(this._readyState=U.CLOSING,this._socket.destroy());else{const e="WebSocket was closed before the connection was established";M(this,this._req,e)}}}function j(e,t,n,i){const s={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:C[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...i,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=s.autoPong,!C.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${C.join(", ")})`);let a;if(t instanceof f)a=t;else try{a=new f(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),e._url=a.href;const u="wss:"===a.protocol,d="ws+unix:"===a.protocol;let p;if("ws:"===a.protocol||u||d?d&&!a.pathname?p="The URL's pathname is empty":a.hash&&(p="The URL contains a fragment identifier"):p='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"',p){const t=new SyntaxError(p);if(0===e._redirects)throw t;return void R(e,t)}const y=u?443:80,m=c(16).toString("base64"),v=u?r.request:o.request,_=new Set;let b,E;if(s.createConnection=s.createConnection||(u?F:B),s.defaultPort=s.defaultPort||y,s.port=a.port||y,s.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,s.headers={...s.headers,"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":m,Connection:"Upgrade",Upgrade:"websocket"},s.path=a.pathname+a.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(b=new h(!0!==s.perMessageDeflate?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=x({[h.extensionName]:b.offer()})),n.length){for(const e of n){if("string"!=typeof e||!A.test(e)||_.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");_.add(e)}s.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin),(a.username||a.password)&&(s.auth=`${a.username}:${a.password}`),d){const e=s.path.split(":");s.socketPath=e[0],s.path=e[1]}if(s.followRedirects){if(0===e._redirects){e._originalIpc=d,e._originalSecure=u,e._originalHostOrSocketPath=d?s.socketPath:a.host;const t=i&&i.headers;if(i={...i,headers:{}},t)for(const[e,n]of Object.entries(t))i.headers[e.toLowerCase()]=n}else if(0===e.listenerCount("redirect")){const t=d?!!e._originalIpc&&s.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!u)&&(delete s.headers.authorization,delete s.headers.cookie,t||delete s.headers.host,s.auth=void 0)}s.auth&&!i.headers.authorization&&(i.headers.authorization="Basic "+Buffer.from(s.auth).toString("base64")),E=e._req=v(s),e._redirects&&e.emit("redirect",e.url,E)}else E=e._req=v(s);s.timeout&&E.on("timeout",(()=>{M(e,E,"Opening handshake has timed out")})),E.on("error",(t=>{null===E||E[L]||(E=e._req=null,R(e,t))})),E.on("response",(r=>{const o=r.headers.location,a=r.statusCode;if(o&&s.followRedirects&&a>=300&&a<400){if(++e._redirects>s.maxRedirects)return void M(e,E,"Maximum redirects exceeded");let r;E.abort();try{r=new f(o,t)}catch(t){const n=new SyntaxError(`Invalid URL: ${o}`);return void R(e,n)}j(e,r,n,i)}else e.emit("unexpected-response",E,r)||M(e,E,`Unexpected server response: ${r.statusCode}`)})),E.on("upgrade",((t,n,i)=>{if(e.emit("upgrade",t),e.readyState!==U.CONNECTING)return;E=e._req=null;const r=t.headers.upgrade;if(void 0===r||"websocket"!==r.toLowerCase())return void M(e,n,"Invalid Upgrade header");const o=l("sha1").update(m+g).digest("base64");if(t.headers["sec-websocket-accept"]!==o)return void M(e,n,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"];let c;if(void 0!==a?_.size?_.has(a)||(c="Server sent an invalid subprotocol"):c="Server sent a subprotocol but none was requested":_.size&&(c="Server sent no subprotocol"),c)return void M(e,n,c);a&&(e._protocol=a);const u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!b){return void M(e,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=O(u)}catch(t){return void M(e,n,"Invalid Sec-WebSocket-Extensions header")}const i=Object.keys(t);if(1!==i.length||i[0]!==h.extensionName){return void M(e,n,"Server indicated an extension that was not requested")}try{b.accept(t[h.extensionName])}catch(t){return void M(e,n,"Invalid Sec-WebSocket-Extensions header")}e._extensions[h.extensionName]=b}e.setSocket(n,i,{allowSynchronousEvents:s.allowSynchronousEvents,generateMask:s.generateMask,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation})})),s.finishRequest?s.finishRequest(E,e):E.end()}function R(e,t){e._readyState=U.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function B(e){return e.path=e.socketPath,s.connect(e)}function F(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=s.isIP(e.host)?"":e.host),a.connect(e)}function M(e,t,n){e._readyState=U.CLOSING;const i=new Error(n);Error.captureStackTrace(i,M),t.setHeader?(t[L]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(R,e,i)):(t.destroy(i),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function $(e,t,n){if(t){const n=m(t)?t.size:I(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){const t=new Error(`WebSocket is not open: readyState ${e.readyState} (${P[e.readyState]})`);process.nextTick(n,t)}}function K(e,t){const n=this[w];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[w]&&(n._socket.removeListener("data",Z),process.nextTick(z,n._socket),1005===e?n.close():n.close(e,t))}function V(){const e=this[w];e.isPaused||e._socket.resume()}function q(e){const t=this[w];void 0!==t._socket[w]&&(t._socket.removeListener("data",Z),process.nextTick(z,t._socket),t.close(e[S])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function W(){this[w].emitClose()}function G(e,t){this[w].emit("message",e,t)}function Y(e){const t=this[w];t._autoPong&&t.pong(e,!this._isServer,T),t.emit("ping",e)}function H(e){this[w].emit("pong",e)}function z(e){e.resume()}function J(e){const t=this[w];t.readyState!==U.CLOSED&&(t.readyState===U.OPEN&&(t._readyState=U.CLOSING,Q(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function Q(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),D)}function X(){const e=this[w];let t;this.removeListener("close",X),this.removeListener("data",Z),this.removeListener("end",ee),e._readyState=U.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[w]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",W),e._receiver.on("finish",W))}function Z(e){this[w]._receiver.write(e)||this.pause()}function ee(){const e=this[w];e._readyState=U.CLOSING,e._receiver.end(),this.end()}function te(){const e=this[w];this.removeListener("error",te),this.on("error",T),e&&(e._readyState=U.CLOSING,this.destroy())}Object.defineProperty(U,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(U.prototype,"CONNECTING",{enumerable:!0,value:P.indexOf("CONNECTING")}),Object.defineProperty(U,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(U.prototype,"OPEN",{enumerable:!0,value:P.indexOf("OPEN")}),Object.defineProperty(U,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(U.prototype,"CLOSING",{enumerable:!0,value:P.indexOf("CLOSING")}),Object.defineProperty(U,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),Object.defineProperty(U.prototype,"CLOSED",{enumerable:!0,value:P.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(U.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(U.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[b])return t[E];return null},set(t){for(const t of this.listeners(e))if(t[b]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[b]:!0})}})})),U.prototype.addEventListener=k,U.prototype.removeEventListener=N,e.exports=U},181:e=>{e.exports=require("buffer")},982:e=>{e.exports=require("crypto")},434:e=>{e.exports=require("events")},611:e=>{e.exports=require("http")},692:e=>{e.exports=require("https")},278:e=>{e.exports=require("net")},203:e=>{e.exports=require("stream")},756:e=>{e.exports=require("tls")},16:e=>{e.exports=require("url")},106:e=>{e.exports=require("zlib")}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}const i=require("express"),r=(require("colors"),require("cors")),o=require("graphql-yoga"),s=require("@graphql-tools/load-files"),a=require("graphql");let c={};function l(){c={}}function u(e){const t=e.name?.value;if(null!=t)switch(d(e,t),e.kind){case"EnumTypeDefinition":if(e.values)for(const n of e.values)d(n,t,n.name.value);break;case"ObjectTypeDefinition":case"InputObjectTypeDefinition":case"InterfaceTypeDefinition":if(e.fields)for(const n of e.fields)if(d(n,t,n.name.value),b(n)&&n.arguments)for(const e of n.arguments)d(e,t,n.name.value,e.name.value)}}function d(e,t,n,i){const r=E(e);if("string"!=typeof r||0===r.length)return;const o=[t];n&&(o.push(n),i&&o.push(i));const s=o.join(".");c[s]||(c[s]=[]),c[s].push(r)}function f(e){return"\n# "+e.replace(/\n/g,"\n# ")}function h(e,t){return e?e.filter((e=>e)).join(t||""):""}function p(e){return e?.some((e=>e.includes("\n")))??!1}function y(e){return e&&`  ${e.replace(/\n/g,"\n  ")}`}function m(e){return e&&0!==e.length?`{\n${y(h(e,"\n"))}\n}`:""}function v(e,t,n){return t?e+t+(n||""):""}const _={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>h(e.definitions,"\n\n")},OperationDefinition:{leave:e=>{const t=v("(",h(e.variableDefinitions,", "),")");return h([e.operation,h([e.name,t]),h(e.directives," ")]," ")+" "+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:n,directives:i})=>e+": "+t+v(" = ",n)+v(" ",h(i," "))},SelectionSet:{leave:({selections:e})=>m(e)},Field:{leave({alias:e,name:t,arguments:n,directives:i,selectionSet:r}){const o=v("",e,": ")+t;let s=o+v("(",h(n,", "),")");return s.length>80&&(s=o+v("(\n",y(h(n,"\n")),"\n)")),h([s,h(i," "),r]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+v(" ",h(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:n})=>h(["...",v("on ",e),h(t," "),n]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:n,directives:i,selectionSet:r})=>`fragment ${e}${v("(",h(n,", "),")")} on ${t} ${v("",h(i," ")," ")}`+r},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?function(e,t=!1){const n=e.replace(/"""/g,'\\"""');return" "!==e[0]&&"\t"!==e[0]||-1!==e.indexOf("\n")?`"""\n${t?n:y(n)}\n"""`:`"""${n.replace(/"$/,'"\n')}"""`}(e):JSON.stringify(e)},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+h(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+h(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+v("(",h(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({directives:e,operationTypes:t})=>h(["schema",h(e," "),m(t)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({name:e,directives:t})=>h(["scalar",e,h(t," ")]," ")},ObjectTypeDefinition:{leave:({name:e,interfaces:t,directives:n,fields:i})=>h(["type",e,v("implements ",h(t," & ")),h(n," "),m(i)]," ")},FieldDefinition:{leave:({name:e,arguments:t,type:n,directives:i})=>e+(p(t)?v("(\n",y(h(t,"\n")),"\n)"):v("(",h(t,", "),")"))+": "+n+v(" ",h(i," "))},InputValueDefinition:{leave:({name:e,type:t,defaultValue:n,directives:i})=>h([e+": "+t,v("= ",n),h(i," ")]," ")},InterfaceTypeDefinition:{leave:({name:e,interfaces:t,directives:n,fields:i})=>h(["interface",e,v("implements ",h(t," & ")),h(n," "),m(i)]," ")},UnionTypeDefinition:{leave:({name:e,directives:t,types:n})=>h(["union",e,h(t," "),v("= ",h(n," | "))]," ")},EnumTypeDefinition:{leave:({name:e,directives:t,values:n})=>h(["enum",e,h(t," "),m(n)]," ")},EnumValueDefinition:{leave:({name:e,directives:t})=>h([e,h(t," ")]," ")},InputObjectTypeDefinition:{leave:({name:e,directives:t,fields:n})=>h(["input",e,h(t," "),m(n)]," ")},DirectiveDefinition:{leave:({name:e,arguments:t,repeatable:n,locations:i})=>"directive @"+e+(p(t)?v("(\n",y(h(t,"\n")),"\n)"):v("(",h(t,", "),")"))+(n?" repeatable":"")+" on "+h(i," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>h(["extend schema",h(e," "),m(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>h(["extend scalar",e,h(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:i})=>h(["extend type",e,v("implements ",h(t," & ")),h(n," "),m(i)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:i})=>h(["extend interface",e,v("implements ",h(t," & ")),h(n," "),m(i)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:n})=>h(["extend union",e,h(t," "),v("= ",h(n," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:n})=>h(["extend enum",e,h(t," "),m(n)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:n})=>h(["extend input",e,h(t," "),m(n)]," ")}},g=Object.keys(_).reduce(((e,t)=>{return{...e,[t]:{leave:(n=_[t].leave,(e,t,i,r,o)=>{const s=[],a=r.reduce(((e,t)=>(["fields","arguments","values"].includes(t)&&e.name&&s.push(e.name.value),e[t])),o[0]),l=[...s,a?.name?.value].filter(Boolean).join("."),u=[];return e.kind.includes("Definition")&&c[l]&&u.push(...c[l]),h([...u.map(f),e.description,n(e,t,i,r,o)],"\n")})}};var n}),{});function b(e){return"FieldDefinition"===e.kind}function E(e){const t=function(e){const t=e.loc;if(!t)return;const n=[];let i=t.startToken.prev;for(;null!=i&&i.kind===a.TokenKind.COMMENT&&null!=i.next&&null!=i.prev&&i.line+1===i.next.line&&i.line!==i.prev.line;){const e=String(i.value);n.push(e),i=i.prev}return n.length>0?n.reverse().join("\n"):void 0}(e);if(void 0!==t)return function(e){const t=e.split(/\r\n|[\n\r]/g),n=function(e){let t=null;for(let n=1;n<e.length;n++){const i=e[n],r=S(i);if(r!==i.length&&((null===t||r<t)&&(t=r,0===t)))break}return null===t?0:t}(t);if(0!==n)for(let e=1;e<t.length;e++)t[e]=t[e].slice(n);for(;t.length>0&&w(t[0]);)t.shift();for(;t.length>0&&w(t[t.length-1]);)t.pop();return t.join("\n")}(`\n${t}`)}function S(e){let t=0;for(;t<e.length&&(" "===e[t]||"\t"===e[t]);)t++;return t}function w(e){return S(e)===e.length}const T=3;function k(e){return N(e,[])}function N(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(e instanceof Error)return"AggregateError"===e.name?x(e)+"\n"+O(e.errors,t):x(e);if(t.includes(e))return"[Circular]";const n=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:N(t,n)}else if(Array.isArray(e))return O(e,n);return function(e,t){const n=Object.entries(e);if(0===n.length)return"{}";if(t.length>T)return"["+function(e){const t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){const t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]";const i=n.map((([e,n])=>e+": "+N(n,t)));return"{ "+i.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}function x(e){return(e.name="GraphQLError")?e.toString():`${e.name}: ${e.message};\n ${e.stack}`}function O(e,t){if(0===e.length)return"[]";if(t.length>T)return"[Array]";const n=e.length,i=[];for(let r=0;r<n;++r)i.push(N(e[r],t));return"["+i.join(", ")+"]"}function I(e){if((0,a.isNonNullType)(e)){const t=I(e.ofType);if(t.kind===a.Kind.NON_NULL_TYPE)throw new Error(`Invalid type node ${k(e)}. Inner type of non-null type cannot be a non-null type.`);return{kind:a.Kind.NON_NULL_TYPE,type:t}}return(0,a.isListType)(e)?{kind:a.Kind.LIST_TYPE,type:I(e.ofType)}:{kind:a.Kind.NAMED_TYPE,name:{kind:a.Kind.NAME,value:e.name}}}function D(e){if(null===e)return{kind:a.Kind.NULL};if(void 0===e)return null;if(Array.isArray(e)){const t=[];for(const n of e){const e=D(n);null!=e&&t.push(e)}return{kind:a.Kind.LIST,values:t}}if("object"==typeof e){if(e?.toJSON)return D(e.toJSON());const t=[];for(const n in e){const i=D(e[n]);i&&t.push({kind:a.Kind.OBJECT_FIELD,name:{kind:a.Kind.NAME,value:n},value:i})}return{kind:a.Kind.OBJECT,fields:t}}if("boolean"==typeof e)return{kind:a.Kind.BOOLEAN,value:e};if("bigint"==typeof e)return{kind:a.Kind.INT,value:String(e)};if("number"==typeof e&&isFinite(e)){const t=String(e);return L.test(t)?{kind:a.Kind.INT,value:t}:{kind:a.Kind.FLOAT,value:t}}if("string"==typeof e)return{kind:a.Kind.STRING,value:e};throw new TypeError(`Cannot convert value to AST: ${e}.`)}const L=/^-?(?:0|[1-9][0-9]*)$/;function C(e,t){if((0,a.isNonNullType)(t)){const n=C(e,t.ofType);return n?.kind===a.Kind.NULL?null:n}if(null===e)return{kind:a.Kind.NULL};if(void 0===e)return null;if((0,a.isListType)(t)){const n=t.ofType;if(function(e){return null!=e&&"object"==typeof e&&Symbol.iterator in e}(e)){const t=[];for(const i of e){const e=C(i,n);null!=e&&t.push(e)}return{kind:a.Kind.LIST,values:t}}return C(e,n)}if((0,a.isInputObjectType)(t)){if(!function(e){return"object"==typeof e&&null!==e}(e))return null;const n=[];for(const i of Object.values(t.getFields())){const t=C(e[i.name],i.type);t&&n.push({kind:a.Kind.OBJECT_FIELD,name:{kind:a.Kind.NAME,value:i.name},value:t})}return{kind:a.Kind.OBJECT,fields:n}}if((0,a.isLeafType)(t)){const n=t.serialize(e);return null==n?null:(0,a.isEnumType)(t)?{kind:a.Kind.ENUM,value:n}:"ID"===t.name&&"string"==typeof n&&P.test(n)?{kind:a.Kind.INT,value:n}:D(n)}console.assert(!1,"Unexpected input type: "+k(t))}const P=/^-?(?:0|[1-9][0-9]*)$/;function A(e){return e.astNode?.description?{...e.astNode.description,block:!0}:e.description?{kind:a.Kind.STRING,value:e.description,block:!0}:void 0}function U(e,t=["directives"]){return t.reduce(((e,t)=>null==e?e:e[t]),e?.extensions)}function j(e){let t;return"alias"in e&&(t=e.alias?.value),null==t&&"name"in e&&(t=e.name?.value),null==t&&(t=e.kind),t}function R(e,t,n){const i=j(e),r=j(t);return"function"==typeof n?n(i,r):function(e,t){return String(e)<String(t)?-1:String(e)>String(t)?1:0}(i,r)}function B(e){return null!=e}function F(e){const t=new WeakMap;return function(n){const i=t.get(n);if(void 0===i){const i=e(n);return t.set(n,i),i}return i}}F((function(e){const t=M(e);return new Set([...t].map((e=>e.name)))}));const M=F((function(e){const t=$(e);return new Set(t.values())})),$=F((function(e){const t=new Map,n=e.getQueryType();n&&t.set("query",n);const i=e.getMutationType();i&&t.set("mutation",i);const r=e.getSubscriptionType();return r&&t.set("subscription",r),t}));function K(e,t={}){const n=t.pathToDirectivesInExtensions,i=e.getTypeMap(),r=function(e,t){const n=new Map([["query",void 0],["mutation",void 0],["subscription",void 0]]),i=[];null!=e.astNode&&i.push(e.astNode);if(null!=e.extensionASTNodes)for(const t of e.extensionASTNodes)i.push(t);for(const e of i)if(e.operationTypes)for(const t of e.operationTypes)n.set(t.operation,t);const r=$(e);for(const[e,t]of n){const i=r.get(e);if(null!=i){const r=I(i);null!=t?t.type=r:n.set(e,{kind:a.Kind.OPERATION_TYPE_DEFINITION,operation:e,type:r})}}const o=[...n.values()].filter(B),s=q(e,e,t);if(!o.length&&!s.length)return null;const c={kind:null!=o?a.Kind.SCHEMA_DEFINITION:a.Kind.SCHEMA_EXTENSION,operationTypes:o,directives:s},l=A(e);l&&(c.description=l);return c}(e,n),o=null!=r?[r]:[],s=e.getDirectives();for(const t of s)(0,a.isSpecifiedDirective)(t)||o.push(V(t,e,n));for(const t in i){const r=i[t],s=(0,a.isSpecifiedScalarType)(r),c=(0,a.isIntrospectionType)(r);if(!s&&!c)if((0,a.isObjectType)(r))o.push(Y(r,e,n));else if((0,a.isInterfaceType)(r))o.push(H(r,e,n));else if((0,a.isUnionType)(r))o.push(z(r,e,n));else if((0,a.isInputObjectType)(r))o.push(J(r,e,n));else if((0,a.isEnumType)(r))o.push(Q(r,e,n));else{if(!(0,a.isScalarType)(r))throw new Error(`Unknown type ${r}.`);o.push(X(r,e,n))}}return{kind:a.Kind.DOCUMENT,definitions:o}}function V(e,t,n){return{kind:a.Kind.DIRECTIVE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},arguments:e.args?.map((e=>G(e,t,n))),repeatable:e.isRepeatable,locations:e.locations?.map((e=>({kind:a.Kind.NAME,value:e})))||[]}}function q(e,t,n){const i=U(e,n);let r,o=[];if(null!=e.astNode&&o.push(e.astNode),"extensionASTNodes"in e&&null!=e.extensionASTNodes&&(o=o.concat(e.extensionASTNodes)),null!=i)r=te(t,i);else{r=[];for(const e of o)e.directives&&r.push(...e.directives)}return r}function W(e,t,n){let i=[],r=null;const o=U(e,n);let s;return s=null!=o?te(t,o):e.astNode?.directives,null!=s&&(i=s.filter((e=>"deprecated"!==e.name.value)),null!=e.deprecationReason&&(r=s.filter((e=>"deprecated"===e.name.value))?.[0])),null!=e.deprecationReason&&null==r&&(r=ee("deprecated",{reason:e.deprecationReason},a.GraphQLDeprecatedDirective)),null==r?i:[r].concat(i)}function G(e,t,n){return{kind:a.Kind.INPUT_VALUE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},type:I(e.type),defaultValue:void 0!==e.defaultValue?C(e.defaultValue,e.type)??void 0:void 0,directives:W(e,t,n)}}function Y(e,t,n){return{kind:a.Kind.OBJECT_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},fields:Object.values(e.getFields()).map((e=>Z(e,t,n))),interfaces:Object.values(e.getInterfaces()).map((e=>I(e))),directives:q(e,t,n)}}function H(e,t,n){const i={kind:a.Kind.INTERFACE_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},fields:Object.values(e.getFields()).map((e=>Z(e,t,n))),directives:q(e,t,n)};return"getInterfaces"in e&&(i.interfaces=Object.values(e.getInterfaces()).map((e=>I(e)))),i}function z(e,t,n){return{kind:a.Kind.UNION_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},directives:q(e,t,n),types:e.getTypes().map((e=>I(e)))}}function J(e,t,n){return{kind:a.Kind.INPUT_OBJECT_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},fields:Object.values(e.getFields()).map((e=>function(e,t,n){return{kind:a.Kind.INPUT_VALUE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},type:I(e.type),directives:W(e,t,n),defaultValue:C(e.defaultValue,e.type)??void 0}}(e,t,n))),directives:q(e,t,n)}}function Q(e,t,n){return{kind:a.Kind.ENUM_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},values:Object.values(e.getValues()).map((e=>function(e,t,n){return{kind:a.Kind.ENUM_VALUE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},directives:W(e,t,n)}}(e,t,n))),directives:q(e,t,n)}}function X(e,t,n){const i=U(e,n),r=i?te(t,i):e.astNode?.directives||[],o=e.specifiedByUrl||e.specifiedByURL;if(o&&!r.some((e=>"specifiedBy"===e.name.value))){const e={url:o};r.push(ee("specifiedBy",e))}return{kind:a.Kind.SCALAR_TYPE_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},directives:r}}function Z(e,t,n){return{kind:a.Kind.FIELD_DEFINITION,description:A(e),name:{kind:a.Kind.NAME,value:e.name},arguments:e.args.map((e=>G(e,t,n))),type:I(e.type),directives:W(e,t,n)}}function ee(e,t,n){const i=[];if(null!=n)for(const e of n.args){const n=e.name,r=t[n];if(void 0!==r){const t=C(r,e.type);t&&i.push({kind:a.Kind.ARGUMENT,name:{kind:a.Kind.NAME,value:n},value:t})}}else for(const e in t){const n=D(t[e]);n&&i.push({kind:a.Kind.ARGUMENT,name:{kind:a.Kind.NAME,value:e},value:n})}return{kind:a.Kind.DIRECTIVE,name:{kind:a.Kind.NAME,value:e},arguments:i}}function te(e,t){const n=[];for(const i in t){const r=t[i],o=e?.getDirective(i);if(Array.isArray(r))for(const e of r)n.push(ee(i,e,o));else n.push(ee(i,r,o))}return n}var ne,ie=n(257);function re(e,t){return!!e.find((e=>e.name.value===t.name.value))}function oe(e,t){return!!t?.[e.name.value]?.repeatable}function se(e,t){return t.some((({value:t})=>t===e.value))}function ae(e,t){const n=[...t];for(const t of e){const e=n.findIndex((e=>e.name.value===t.name.value));if(e>-1){const i=n[e];if("ListValue"===i.value.kind){const e=i.value.values,n=t.value.values;i.value.values=ue(e,n,((e,t)=>{const n=e.value;return!n||!t.some((e=>e.value===n))}))}else i.value=t.value}else n.push(t)}return n}function ce(e=[],t=[],n,i){const r=n&&n.reverseDirectives,o=r?t:e,s=function(e,t){return e.map(((e,n,i)=>{const r=i.findIndex((t=>t.name.value===e.name.value));if(r!==n&&!oe(e,t)){const t=i[r];return e.arguments=ae(e.arguments,t.arguments),null}return e})).filter(B)}([...r?e:t],i);for(const e of o)if(re(s,e)&&!oe(e,i)){const t=s.findIndex((t=>t.name.value===e.name.value)),n=s[t];s[t].arguments=ae(e.arguments||[],n.arguments||[])}else s.push(e);return s}function le(e,t){return t?{...e,arguments:ue(t.arguments||[],e.arguments||[],((e,t)=>!se(e.name,t.map((e=>e.name))))),locations:[...t.locations,...e.locations.filter((e=>!se(e,t.locations)))]}:e}function ue(e,t,n){return e.concat(t.filter((t=>n(t,e))))}function de(e,t,n,i){if(n?.consistentEnumMerge){const n=[];e&&n.push(...e),e=t,t=n}const r=new Map;if(e)for(const t of e)r.set(t.name.value,t);if(t)for(const e of t){const t=e.name.value;if(r.has(t)){const n=r.get(t);n.description=e.description||n.description,n.directives=ce(e.directives,n.directives,i)}else r.set(t,e)}const o=[...r.values()];return n&&n.sort&&o.sort(R),o}function fe(e,t,n,i){return t?{name:e.name,description:e.description||t.description,kind:n?.convertExtensions||"EnumTypeDefinition"===e.kind||"EnumTypeDefinition"===t.kind?"EnumTypeDefinition":"EnumTypeExtension",loc:e.loc,directives:ce(e.directives,t.directives,n,i),values:de(e.values,t.values,n)}:n?.convertExtensions?{...e,kind:a.Kind.ENUM_TYPE_DEFINITION}:e}function he(e,t,n){const i=function(e,t){return e.reduce(((e,n)=>{const i=e.findIndex((e=>e.name.value===n.name.value));return-1===i?e.concat([n]):(t?.reverseArguments||(e[i]=n),e)}),[])}([...t,...e].filter(B),n);return n&&n.sort&&i.sort(R),i}function pe(e){let t=e;for(;t.kind===a.Kind.LIST_TYPE||"NonNullType"===t.kind;)t=t.type;return t}function ye(e){return e.kind!==a.Kind.NAMED_TYPE}function me(e){return e.kind===a.Kind.LIST_TYPE}function ve(e){return e.kind===a.Kind.NON_NULL_TYPE}function _e(e){return me(e)?`[${_e(e.type)}]`:ve(e)?`${_e(e.type)}!`:e.name.value}function ge(e,t){return null==e&&null==t?ne.A_EQUALS_B:null==e?ne.A_SMALLER_THAN_B:null==t?ne.A_GREATER_THAN_B:e<t?ne.A_SMALLER_THAN_B:e>t?ne.A_GREATER_THAN_B:ne.A_EQUALS_B}function be(e,t){const n=e.findIndex((e=>e.name.value===t.name.value));return[n>-1?e[n]:null,n]}function Ee(e,t,n,i,r){const o=[];if(null!=n&&o.push(...n),null!=t)for(const n of t){const[t,s]=be(o,n);if(t&&!i?.ignoreFieldConflicts){const a=i?.onFieldTypeConflict&&i.onFieldTypeConflict(t,n,e,i?.throwOnConflict)||Se(e,t,n,i?.throwOnConflict);a.arguments=he(n.arguments||[],t.arguments||[],i),a.directives=ce(n.directives,t.directives,i,r),a.description=n.description||t.description,o[s]=a}else o.push(n)}if(i&&i.sort&&o.sort(R),i&&i.exclusions){const t=i.exclusions;return o.filter((n=>!t.includes(`${e.name.value}.${n.name.value}`)))}return o}function Se(e,t,n,i=!1){const r=_e(t.type),o=_e(n.type);if(r!==o){const s=pe(t.type),a=pe(n.type);if(s.name.value!==a.name.value)throw new Error(`Field "${n.name.value}" already defined with a different type. Declared as "${s.name.value}", but you tried to override with "${a.name.value}"`);if(!we(t.type,n.type,!i))throw new Error(`Field '${e.name.value}.${t.name.value}' changed type from '${r}' to '${o}'`)}return ve(n.type)&&!ve(t.type)&&(t.type=n.type),t}function we(e,t,n=!1){if(!ye(e)&&!ye(t))return e.toString()===t.toString();if(ve(t)){return we(ve(e)?e.type:e,t.type)}return ve(e)?we(t,e,n):!!me(e)&&(me(t)&&we(e.type,t.type)||ve(t)&&we(e,t.type))}function Te(e,t,n,i){if(t)try{return{name:e.name,description:e.description||t.description,kind:n?.convertExtensions||"InputObjectTypeDefinition"===e.kind||"InputObjectTypeDefinition"===t.kind?"InputObjectTypeDefinition":"InputObjectTypeExtension",loc:e.loc,fields:Ee(e,e.fields,t.fields,n),directives:ce(e.directives,t.directives,n,i)}}catch(t){throw new Error(`Unable to merge GraphQL input type "${e.name.value}": ${t.message}`)}return n?.convertExtensions?{...e,kind:a.Kind.INPUT_OBJECT_TYPE_DEFINITION}:e}function ke(e=[],t=[],n={}){const i=[...t,...e.filter((e=>{return n=e,!t.find((e=>e.name.value===n.name.value));var n}))];return n&&n.sort&&i.sort(R),i}function Ne(e,t,n,i){if(t)try{return{name:e.name,description:e.description||t.description,kind:n?.convertExtensions||"InterfaceTypeDefinition"===e.kind||"InterfaceTypeDefinition"===t.kind?"InterfaceTypeDefinition":"InterfaceTypeExtension",loc:e.loc,fields:Ee(e,e.fields,t.fields,n),directives:ce(e.directives,t.directives,n,i),interfaces:e.interfaces?ke(e.interfaces,t.interfaces,n):void 0}}catch(t){throw new Error(`Unable to merge GraphQL interface "${e.name.value}": ${t.message}`)}return n?.convertExtensions?{...e,kind:a.Kind.INTERFACE_TYPE_DEFINITION}:e}function xe(e,t,n,i){return t?{name:e.name,description:e.description||t.description,kind:n?.convertExtensions||"ScalarTypeDefinition"===e.kind||"ScalarTypeDefinition"===t.kind?"ScalarTypeDefinition":"ScalarTypeExtension",loc:e.loc,directives:ce(e.directives,t.directives,n,i)}:n?.convertExtensions?{...e,kind:a.Kind.SCALAR_TYPE_DEFINITION}:e}!function(e){e[e.A_SMALLER_THAN_B=-1]="A_SMALLER_THAN_B",e[e.A_EQUALS_B=0]="A_EQUALS_B",e[e.A_GREATER_THAN_B=1]="A_GREATER_THAN_B"}(ne||(ne={}));const Oe={query:"Query",mutation:"Mutation",subscription:"Subscription"};function Ie(e=[],t=[]){const n=[];for(const i in Oe){const r=e.find((e=>e.operation===i))||t.find((e=>e.operation===i));r&&n.push(r)}return n}function De(e,t,n,i){return t?{kind:e.kind===a.Kind.SCHEMA_DEFINITION||t.kind===a.Kind.SCHEMA_DEFINITION?a.Kind.SCHEMA_DEFINITION:a.Kind.SCHEMA_EXTENSION,description:e.description||t.description,directives:ce(e.directives,t.directives,n,i),operationTypes:Ie(e.operationTypes,t.operationTypes)}:n?.convertExtensions?{...e,kind:a.Kind.SCHEMA_DEFINITION}:e}function Le(e,t,n,i){if(t)try{return{name:e.name,description:e.description||t.description,kind:n?.convertExtensions||"ObjectTypeDefinition"===e.kind||"ObjectTypeDefinition"===t.kind?"ObjectTypeDefinition":"ObjectTypeExtension",loc:e.loc,fields:Ee(e,e.fields,t.fields,n),directives:ce(e.directives,t.directives,n,i),interfaces:ke(e.interfaces,t.interfaces,n)}}catch(t){throw new Error(`Unable to merge GraphQL type "${e.name.value}": ${t.message}`)}return n?.convertExtensions?{...e,kind:a.Kind.OBJECT_TYPE_DEFINITION}:e}function Ce(e,t,n,i){return t?{name:e.name,description:e.description||t.description,directives:ce(e.directives,t.directives,n,i),kind:n?.convertExtensions||"UnionTypeDefinition"===e.kind||"UnionTypeDefinition"===t.kind?a.Kind.UNION_TYPE_DEFINITION:a.Kind.UNION_TYPE_EXTENSION,loc:e.loc,types:ke(e.types,t.types,n)}:n?.convertExtensions?{...e,kind:a.Kind.UNION_TYPE_DEFINITION}:e}const Pe="SCHEMA_DEF_SYMBOL";function Ae(e,t,n={}){const i=n;for(const r of e)if("name"in r){const e=r.name?.value;if(t?.commentDescriptions&&u(r),null==e)continue;if(t?.exclusions?.includes(e+".*")||t?.exclusions?.includes(e))delete i[e];else switch(r.kind){case a.Kind.OBJECT_TYPE_DEFINITION:case a.Kind.OBJECT_TYPE_EXTENSION:i[e]=Le(r,i[e],t,n);break;case a.Kind.ENUM_TYPE_DEFINITION:case a.Kind.ENUM_TYPE_EXTENSION:i[e]=fe(r,i[e],t,n);break;case a.Kind.UNION_TYPE_DEFINITION:case a.Kind.UNION_TYPE_EXTENSION:i[e]=Ce(r,i[e],t,n);break;case a.Kind.SCALAR_TYPE_DEFINITION:case a.Kind.SCALAR_TYPE_EXTENSION:i[e]=xe(r,i[e],t,n);break;case a.Kind.INPUT_OBJECT_TYPE_DEFINITION:case a.Kind.INPUT_OBJECT_TYPE_EXTENSION:i[e]=Te(r,i[e],t,n);break;case a.Kind.INTERFACE_TYPE_DEFINITION:case a.Kind.INTERFACE_TYPE_EXTENSION:i[e]=Ne(r,i[e],t,n);break;case a.Kind.DIRECTIVE_DEFINITION:if(i[e]){e in{}&&((0,ie.Ll)(i[e])||(i[e]=void 0))}i[e]=le(r,i[e])}}else r.kind!==a.Kind.SCHEMA_DEFINITION&&r.kind!==a.Kind.SCHEMA_EXTENSION||(i[Pe]=De(r,i[Pe],t));return i}function Ue(e,t,n=[],i=[],r=new Set){if(e&&!r.has(e))if(r.add(e),"function"==typeof e)Ue(e(),t,n,i,r);else if(Array.isArray(e))for(const o of e)Ue(o,t,n,i,r);else if((0,a.isSchema)(e)){Ue(K(e,t).definitions,t,n,i,r)}else if("string"==typeof e||function(e){return e instanceof a.Source}(e)){Ue((0,a.parse)(e,t).definitions,t,n,i,r)}else if("object"==typeof e&&(0,a.isDefinitionNode)(e))e.kind===a.Kind.DIRECTIVE_DEFINITION?n.push(e):i.push(e);else{if(!(o=e)||"object"!=typeof o||!("kind"in o)||o.kind!==a.Kind.DOCUMENT)throw new Error("typeDefs must contain only strings, documents, schemas, or functions, got "+typeof e);Ue(e.definitions,t,n,i,r)}var o;return{allDirectives:n,allNodes:i}}function je(e,t){l();const{allDirectives:n,allNodes:i}=Ue(e,t),r=Ae(n,t),o=Ae(i,t,r);if(t?.useSchemaDefinition){const e=o[Pe]||{kind:a.Kind.SCHEMA_DEFINITION,operationTypes:[]},t=e.operationTypes;for(const e in Oe){if(!t.find((t=>t.operation===e))){const n=o[Oe[e]];null!=n&&null!=n.name&&t.push({kind:a.Kind.OPERATION_TYPE_DEFINITION,type:{kind:a.Kind.NAMED_TYPE,name:n.name},operation:e})}}null!=e?.operationTypes?.length&&e.operationTypes.length>0&&(o[Pe]=e)}t?.forceSchemaDefinition&&!o[Pe]?.operationTypes?.length&&(o[Pe]={kind:a.Kind.SCHEMA_DEFINITION,operationTypes:[{kind:a.Kind.OPERATION_TYPE_DEFINITION,operation:"query",type:{kind:a.Kind.NAMED_TYPE,name:{kind:a.Kind.NAME,value:"Query"}}}]});const s=Object.values(o);if(t?.sort){const e="function"==typeof t.sort?t.sort:ge;s.sort(((t,n)=>e(t.name?.value,n.name?.value)))}return s}n(719),n(286),n(914),n(60);var Re=n(722);function Be(e){return null===e?"null":Array.isArray(e)?"array":typeof e}function Fe(e){return"object"===Be(e)}function Me(e){return Fe(e)&&"function"==typeof Object(e)[Symbol.asyncIterator]&&"function"==typeof e.return}function $e(e){return Array.isArray(e)&&e.length>0&&e.every((e=>"message"in e))}const Ke="graphql-transport-ws";var Ve,qe;function We(e){if(!Fe(e))throw new Error(`Message is expected to be an object, but got ${Be(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if("string"!=typeof e.type)throw new Error(`Message is expects the 'type' property to be a string, but got ${Be(e.type)}`);switch(e.type){case qe.ConnectionInit:case qe.ConnectionAck:case qe.Ping:case qe.Pong:if(null!=e.payload&&!Fe(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or nullish or missing, but got "${e.payload}"`);break;case qe.Subscribe:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${Be(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!Fe(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${Be(e.payload)}`);if("string"!=typeof e.payload.query)throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${Be(e.payload.query)}`);if(null!=e.payload.variables&&!Fe(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${Be(e.payload.variables)}`);if(null!=e.payload.operationName&&"string"!==Be(e.payload.operationName))throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${Be(e.payload.operationName)}`);if(null!=e.payload.extensions&&!Fe(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${Be(e.payload.extensions)}`);break;case qe.Next:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${Be(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!Fe(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${Be(e.payload)}`);break;case qe.Error:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${Be(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!$e(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break;case qe.Complete:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${Be(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break;default:throw new Error(`Invalid message 'type' property "${e.type}"`)}return e}function Ge(e,t){return We(e),JSON.stringify(e,t)}!function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"}(Ve||(Ve={})),function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"}(qe||(qe={}));var Ye=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}};function He(e){const{schema:t,context:n,roots:i,validate:r,execute:o,subscribe:s,connectionInitWaitTimeout:c=3e3,onConnect:l,onDisconnect:u,onClose:d,onSubscribe:f,onOperation:h,onNext:p,onError:y,onComplete:m,jsonMessageReviver:v,jsonMessageReplacer:_}=e;return{opened(e,g){const b={connectionInitReceived:!1,acknowledged:!1,subscriptions:{},extra:g};if(e.protocol!==Ke)return e.close(Ve.SubprotocolNotAcceptable,"Subprotocol not acceptable"),async(e,t)=>{await(null==d?void 0:d(b,e,t))};const E=c>0&&isFinite(c)?setTimeout((()=>{b.connectionInitReceived||e.close(Ve.ConnectionInitialisationTimeout,"Connection initialisation timeout")}),c):null;return e.onMessage((async function(c){var u,d,g,E,S;let w;try{w=function(e,t){return We("string"==typeof e?JSON.parse(e,t):e)}(c,v)}catch(t){return e.close(Ve.BadRequest,"Invalid message received")}switch(w.type){case qe.ConnectionInit:{if(b.connectionInitReceived)return e.close(Ve.TooManyInitialisationRequests,"Too many initialisation requests");b.connectionInitReceived=!0,Fe(w.payload)&&(b.connectionParams=w.payload);const t=await(null==l?void 0:l(b));return!1===t?e.close(Ve.Forbidden,"Forbidden"):(b.acknowledged=!0,void await e.send(Ge(Fe(t)?{type:qe.ConnectionAck,payload:t}:{type:qe.ConnectionAck},_)))}case qe.Ping:return e.onPing?await e.onPing(w.payload):void await e.send(Ge(w.payload?{type:qe.Pong,payload:w.payload}:{type:qe.Pong}));case qe.Pong:return await(null===(S=e.onPong)||void 0===S?void 0:S.call(e,w.payload));case qe.Subscribe:{if(!b.acknowledged)return e.close(Ve.Unauthorized,"Unauthorized");const{id:c,payload:l}=w;if(c in b.subscriptions)return e.close(Ve.SubscriberAlreadyExists,`Subscriber for ${c} already exists`);b.subscriptions[c]=null;const v={next:async(t,n)=>{let i={id:c,type:qe.Next,payload:t};const r=await(null==p?void 0:p(b,i,n,t));r&&(i=Object.assign(Object.assign({},i),{payload:r})),await e.send(Ge(i,_))},error:async t=>{let n={id:c,type:qe.Error,payload:t};const i=await(null==y?void 0:y(b,n,t));i&&(n=Object.assign(Object.assign({},n),{payload:i})),await e.send(Ge(n,_))},complete:async t=>{const n={id:c,type:qe.Complete};await(null==m?void 0:m(b,n)),t&&await e.send(Ge(n,_))}};try{let e;const p=await(null==f?void 0:f(b,w));if(p){if($e(p))return c in b.subscriptions?await v.error(p):void 0;if(Array.isArray(p))throw new Error("Invalid return value from onSubscribe hook, expected an array of GraphQLError objects");e=p}else{if(!t)throw new Error("The GraphQL schema is not provided");const n={operationName:l.operationName,document:(0,a.parse)(l.query),variableValues:l.variables};e=Object.assign(Object.assign({},n),{schema:"function"==typeof t?await t(b,w,n):t});const i=(null!=r?r:a.validate)(e.schema,e.document);if(i.length>0)return c in b.subscriptions?await v.error(i):void 0}const y=(0,a.getOperationAST)(e.document,e.operationName);if(!y)return c in b.subscriptions?await v.error([new a.GraphQLError("Unable to identify operation")]):void 0;let m;"rootValue"in e||(e.rootValue=null==i?void 0:i[y.operation]),"contextValue"in e||(e.contextValue="function"==typeof n?await n(b,w,e):n),m="subscription"===y.operation?await(null!=s?s:a.subscribe)(e):await(null!=o?o:a.execute)(e);const _=await(null==h?void 0:h(b,w,e,m));if(_&&(m=_),"function"==typeof Object(m)[Symbol.asyncIterator])if(c in b.subscriptions){b.subscriptions[c]=m;try{for(var T,k=!0,N=Ye(m);!(u=(T=await N.next()).done);k=!0){E=T.value,k=!1;const t=E;await v.next(t,e)}}catch(e){d={error:e}}finally{try{k||u||!(g=N.return)||await g.call(N)}finally{if(d)throw d.error}}}else Me(m)&&m.return(void 0);else c in b.subscriptions&&await v.next(m,e);await v.complete(c in b.subscriptions)}finally{delete b.subscriptions[c]}return}case qe.Complete:{const e=b.subscriptions[w.id];return delete b.subscriptions[w.id],void(Me(e)&&await e.return(void 0))}default:throw new Error(`Unexpected message of type ${w.type} received`)}})),async(e,t)=>{E&&clearTimeout(E);const n=Object.assign({},b.subscriptions);b.subscriptions={},await Promise.all(Object.values(n).filter(Me).map((e=>e.return(void 0)))),b.acknowledged&&await(null==u?void 0:u(b,e,t)),await(null==d?void 0:d(b,e,t))}}}}function ze(e){switch(!0){case e instanceof Set&&e.has(Ke):case Array.isArray(e)&&e.includes(Ke):case"string"==typeof e&&e.split(",").map((e=>e.trim())).includes(Ke):return Ke;default:return!1}}const Je=require("path");var Qe=[{id:"1",name:"John Doe",email:"john@example.com"},{id:"2",name:"Jane Smith",email:"jane@example.com"}],Xe={Query:{hello:function(){return"world"},users:function(){return Qe},user:function(e,t){var n=t.id;return Qe.find((function(e){return e.id===n}))}}};function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function tt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Ze(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=Ze(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ze(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=new(require("graphql-subscriptions").PubSub),it={Mutation:{createUser:function(e,t){var n=t.input,i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:String(Qe.length+1)},n);return Qe.push(i),{user:i,msg:"user added successfully"}},updateUser:function(e,t){var n=t.id,i=t.input,r=Qe.findIndex((function(e){return e.id===n}));return-1!==r?(i.name&&(Qe[r].name=i.name),i.email&&(Qe[r].email=i.email),{user:Qe[r],msg:"User updated successfully "}):{msg:"Invalid userID"}},deleteUser:function(e,t){var n=t.id,i=Qe.findIndex((function(e){return e.id===n}));if(-1!==i){var r=Qe.splice(i,1)[0];return nt.publish("USER_DELETED",{userDeleted:r}),{id:r.id,success:!0,message:"user deleted successfully"}}return{id:n,success:!1,message:"User not found"}}},Subscription:{userDeleted:{subscribe:function(){return nt.asyncIterator(["USER_DELETED"])}},greetings:{subscribe:function(){return nt.asyncIterator(["GREETINGS"])}}}};function rt(e){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rt(e)}function ot(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ot=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,i){var o=t&&t.prototype instanceof v?t:v,s=Object.create(o.prototype),a=new D(i||[]);return r(s,"_invoke",{value:N(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",p="executing",y="completed",m={};function v(){}function _(){}function g(){}var b={};l(b,s,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==n&&i.call(S,s)&&(b=S);var w=g.prototype=v.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(r,o,s,a){var c=d(e[r],e,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==rt(u)&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}})}function N(t,n,i){var r=f;return function(o,s){if(r===p)throw Error("Generator is already running");if(r===y){if("throw"===o)throw s;return{value:e,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var c=x(a,i);if(c){if(c===m)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===f)throw r=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var l=d(t,n,i);if("normal"===l.type){if(r=i.done?y:h,l.arg===m)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r=y,i.method="throw",i.arg=l.arg)}}}function x(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var o=d(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function L(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(rt(t)+" is not iterable")}return _.prototype=g,r(w,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:_,configurable:!0}),_.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},T(k.prototype),l(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new k(u(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(w),l(w,c,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=L,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:L(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),m}},t}function st(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){lt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=rt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=rt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}setInterval((function(){nt.publish("GREETINGS",{greetings:"Hello, World!"})}),5e3);var ut=function(e,t){l();const n={kind:a.Kind.DOCUMENT,definitions:je(e,{useSchemaDefinition:!0,forceSchemaDefinition:!1,throwOnConflict:!1,commentDescriptions:!1,...t})};let i;return i=t?.commentDescriptions?function(e){return(0,a.visit)(e,g)}(n):n,l(),i}((0,s.loadFilesSync)("./schema/typeDefs",{extensions:["gql","graphql"]})),dt=ct(ct({},Xe),it),ft=(0,o.createSchema)({typeDefs:ut,resolvers:dt}),ht=(0,o.createYoga)({graphqlEndpoint:"/graphql",schema:ft,graphiql:{subscriptionsProtocol:"WS"}}),pt=i();pt.use(r());var yt=Je.resolve(),mt=(0,Je.join)(yt,"client","dist");pt.use(i.static(mt)),pt.get("*",(function(e,t,n){if(e.path.startsWith("/graphql")||"/restapi"===e.path)return n();t.sendFile((0,Je.join)(mt,"index.html"))})),pt.use("/graphql",ht),pt.get("/restapi",(function(e,t){t.status(200).json({users:Qe})})),pt.delete("/restapi/:id",(function(e,t){var n=e.params.id,i=Qe.findIndex((function(e){return e.id===n}));return-1!==i?(Qe.splice(i,1),t.json({msg:"User with id ".concat(n," deleted successfully")})):t.status(404).json({msg:"User with id ".concat(n," not found")})}));var vt,_t,gt=new Re({noServer:!0,path:ht.graphqlEndpoint});!function(e,t,n=12e3){const i=He(e);t.options.handleProtocols=ze,t.once("error",(e=>{console.error("Internal error emitted on the WebSocket server. Please check your implementation.",e);let n=null;for(const i of t.clients)try{i.close(Ve.InternalServerError,"Internal server error")}catch(e){n=null!=n?n:e}if(n)throw n})),t.on("connection",((e,t)=>{e.once("error",(t=>{console.error("Internal error emitted on a WebSocket socket. Please check your implementation.",t),e.close(Ve.InternalServerError,"Internal server error")}));let r=null;const o=n>0&&isFinite(n)?setInterval((()=>{e.readyState===e.OPEN&&(r=setTimeout((()=>{e.terminate()}),n),e.once("pong",(()=>{r&&(clearTimeout(r),r=null)})),e.ping())}),n):null,s=i.opened({protocol:e.protocol,send:t=>new Promise(((n,i)=>{if(e.readyState!==e.OPEN)return n();e.send(t,(e=>e?i(e):n()))})),close:(t,n)=>e.close(t,n),onMessage:t=>e.on("message",(async n=>{try{await t(String(n))}catch(t){console.error("Internal error occurred during message handling. Please check your implementation.",t),e.close(Ve.InternalServerError,"Internal server error")}}))},{socket:e,request:t});e.once("close",((e,t)=>{r&&clearTimeout(r),o&&clearInterval(o),s(e,String(t))}))}))}({execute:function(e){return e.rootValue.execute(e)},subscribe:function(e){return e.rootValue.subscribe(e)},onSubscribe:(vt=ot().mark((function e(t,n){var i,r,o,s,a,c,l,u,d;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ht.getEnveloped(ct(ct({},t),{},{req:t.extra.request,socket:t.extra.socket,params:n.payload})),r=i.schema,o=i.execute,s=i.subscribe,a=i.contextFactory,c=i.parse,l=i.validate,e.t0=r,e.t1=n.payload.operationName,e.t2=c(n.payload.query),e.t3=n.payload.variables,e.next=7,a();case 7:if(e.t4=e.sent,e.t5={execute:o,subscribe:s},u={schema:e.t0,operationName:e.t1,document:e.t2,variableValues:e.t3,contextValue:e.t4,rootValue:e.t5},!(d=l(u.schema,u.document)).length){e.next=13;break}return e.abrupt("return",d);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})),_t=function(){var e=this,t=arguments;return new Promise((function(n,i){var r=vt.apply(e,t);function o(e){st(r,n,i,o,s,"next",e)}function s(e){st(r,n,i,o,s,"throw",e)}o(void 0)}))},function(e,t){return _t.apply(this,arguments)})},gt);var bt=process.env.PORT||4e3;pt.listen(bt,(function(){console.log("Server is active on port ".concat(bt))})).on("upgrade",(function(e,t,n){gt.handleUpgrade(e,t,n,(function(t){gt.emit("connection",t,e)}))}))})();
//# sourceMappingURL=bundle.js.map